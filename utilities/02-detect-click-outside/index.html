<!DOCTYPE html>
<html>
<head><title>Detect click outside</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#ffffff">
<link rel="stylesheet" type="text/css" href="/vue-cookbook/assets/_default.page.client.ts.5fde2695.css"><link rel="modulepreload" as="script" type="text/javascript" href="/vue-cookbook/assets/vendor.081cd380.js"></head>
<body class="antialiased text-gray-900">
  <div id="app"><article class="absolute inset-0 grid grid-cols-[auto,1fr] grid-rows-[auto,1fr]"><div class="w-0 md:w-64 row-span-2 overflow-hidden"><aside class="hidden md:block md:translate-x-0 fixed inset-0 md:w-64 overflow-scroll bg-gray-50 z-10 p-6 transition ease-in-out transform"><div class="flex justify-center"><a href="/vue-cookbook/" class="font-bold"> Vue Cookbook </a><!----></div><hr class="mt-4"><nav class="mt-6 overflow-hidden"><ul class="space-y-4"><li><a href="/vue-cookbook/" class="font-semibold"><!--[--> Introduction <!--]--></a></li><li><div class="font-semibold" href="/content">Content</div></li><li><div class="font-semibold" href="/effects">Effects</div></li><li><div class="font-semibold" href="/layouts">Layouts</div></li><li><div class="font-semibold" href="/interactive">Interactive</div><ul class="ml-4 mt-2 space-y-2 leading-snug"><li><a href="/vue-cookbook/interactive/01-create-a-floating-component" class=""><!--[--> Create a floating component <!--]--></a></li></ul></li><li><div class="font-semibold" href="/utilities">Utilities</div><ul class="ml-4 mt-2 space-y-2 leading-snug"><li><a href="/vue-cookbook/utilities/01-assert-with-type-assertion" class=""><!--[--> Assert with type assertion <!--]--></a></li><li><a href="/vue-cookbook/utilities/02-detect-click-outside" class="text-blue-700 font-medium"><!--[--> Detect click outside <!--]--></a></li><li><a href="/vue-cookbook/utilities/03-pass-data-along-tree" class=""><!--[--> Pass data along tree <!--]--></a></li></ul></li></ul></nav></aside></div><header class="col-start-2 px-6 py-4 flex items-center justify-between"><button class="-ml-2.5 text-2xl font-medium text-gray-400 px-3 py-1 rounded hover:bg-gray-100 focus:outline-none"> â‰¡ </button><a class="h-6" href="https://github.com/lem0nle/vpage" target="_blank" rel="noopener"><svg class="h-6 text-gray-400 fill-current" aria-hidden="true" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg></a></header><main class="col-start-2 overflow-scroll"><article class="prose mx-auto p-6"><!--[--><!--[--><h1>Detect click outside</h1><h2>Problem</h2><p>You want to detect clicks outside an element.</p><h2>Solution</h2><p>The basic idea is to globally capture clicks, and check whether the clicked element is inside the element of our concern. We need a <a href="https://v3.vuejs.org/guide/composition-api-template-refs.html">template ref</a> to specify the element, and a callback function. Event listener is loaded / removed along with the Vue component.</p><div><pre class="shiki" style="background-color: #282A36"><code><span class="line"><span style="color: #F286C4">function</span><span style="color: #F6F6F4"> </span><span style="color: #62E884">useClickOutside</span><span style="color: #F6F6F4">(</span></span>
<span class="line"><span style="color: #F6F6F4">  </span><span style="color: #FFB86C; font-style: italic">el</span><span style="color: #F286C4">:</span><span style="color: #F6F6F4"> </span><span style="color: #97E1F1; font-style: italic">Ref</span><span style="color: #F6F6F4">&lt;</span><span style="color: #FFB86C; font-style: italic">HTMLElement</span><span style="color: #F6F6F4"> </span><span style="color: #F286C4">|</span><span style="color: #F6F6F4"> </span><span style="color: #97E1F1; font-style: italic">null</span><span style="color: #F6F6F4">&gt;,</span></span>
<span class="line"><span style="color: #F6F6F4">  </span><span style="color: #62E884">onClickOutside</span><span style="color: #F286C4">:</span><span style="color: #F6F6F4"> () </span><span style="color: #F286C4">=&gt;</span><span style="color: #F6F6F4"> </span><span style="color: #97E1F1; font-style: italic">void</span><span style="color: #F6F6F4">,</span></span>
<span class="line"><span style="color: #F6F6F4">  </span><span style="color: #FFB86C; font-style: italic">mouseEvent</span><span style="color: #F286C4">:</span><span style="color: #F6F6F4"> </span><span style="color: #DEE492">&#39;</span><span style="color: #E7EE98">click</span><span style="color: #DEE492">&#39;</span><span style="color: #F6F6F4"> </span><span style="color: #F286C4">|</span><span style="color: #F6F6F4"> </span><span style="color: #DEE492">&#39;</span><span style="color: #E7EE98">dblclick</span><span style="color: #DEE492">&#39;</span><span style="color: #F6F6F4"> </span><span style="color: #F286C4">|</span><span style="color: #F6F6F4"> </span><span style="color: #DEE492">&#39;</span><span style="color: #E7EE98">mouseup</span><span style="color: #DEE492">&#39;</span><span style="color: #F6F6F4"> </span><span style="color: #F286C4">=</span><span style="color: #F6F6F4"> </span><span style="color: #DEE492">&#39;</span><span style="color: #E7EE98">click</span><span style="color: #DEE492">&#39;</span><span style="color: #F6F6F4">,</span></span>
<span class="line"><span style="color: #F6F6F4">) {</span></span>
<span class="line"><span style="color: #F6F6F4">  </span><span style="color: #F286C4">const</span><span style="color: #F6F6F4"> </span><span style="color: #62E884">listener</span><span style="color: #F6F6F4"> </span><span style="color: #F286C4">=</span><span style="color: #F6F6F4"> (</span><span style="color: #FFB86C; font-style: italic">e</span><span style="color: #F286C4">:</span><span style="color: #F6F6F4"> </span><span style="color: #97E1F1; font-style: italic">Event</span><span style="color: #F6F6F4">) </span><span style="color: #F286C4">=&gt;</span><span style="color: #F6F6F4"> {</span></span>
<span class="line"><span style="color: #F6F6F4">    </span><span style="color: #F286C4">if</span><span style="color: #F6F6F4"> (el.value </span><span style="color: #F286C4">&amp;&amp;</span><span style="color: #F6F6F4"> </span><span style="color: #F286C4">!</span><span style="color: #F6F6F4">el.value.</span><span style="color: #62E884">contains</span><span style="color: #F6F6F4">(e.target </span><span style="color: #F286C4">as</span><span style="color: #F6F6F4"> </span><span style="color: #97E1F1; font-style: italic">HTMLElement</span><span style="color: #F6F6F4">)) {</span></span>
<span class="line"><span style="color: #F6F6F4">      </span><span style="color: #62E884">onClickOutside</span><span style="color: #F6F6F4">()</span></span>
<span class="line"><span style="color: #F6F6F4">    }</span></span>
<span class="line"><span style="color: #F6F6F4">  }</span></span>
<span class="line"><span style="color: #F6F6F4">  </span><span style="color: #62E884">onMounted</span><span style="color: #F6F6F4">(() </span><span style="color: #F286C4">=&gt;</span><span style="color: #F6F6F4"> {</span></span>
<span class="line"><span style="color: #F6F6F4">    document.</span><span style="color: #62E884">addEventListener</span><span style="color: #F6F6F4">(mouseEvent, listener)</span></span>
<span class="line"><span style="color: #F6F6F4">  })</span></span>
<span class="line"><span style="color: #F6F6F4">  </span><span style="color: #62E884">onBeforeUnmount</span><span style="color: #F6F6F4">(() </span><span style="color: #F286C4">=&gt;</span><span style="color: #F6F6F4"> {</span></span>
<span class="line"><span style="color: #F6F6F4">    document.</span><span style="color: #62E884">removeEventListener</span><span style="color: #F6F6F4">(mouseEvent, listener)</span></span>
<span class="line"><span style="color: #F6F6F4">  })</span></span>
<span class="line"><span style="color: #F6F6F4">}</span></span>
<span class="line"></span></code></pre></div><p>Another way is to provide a custom <code>v-click-outside</code> <a href="https://v3.vuejs.org/guide/custom-directive.html">directive</a>:</p><div><pre class="shiki" style="background-color: #282A36"><code><span class="line"><span style="color: #F286C4">function</span><span style="color: #F6F6F4"> </span><span style="color: #62E884">listener</span><span style="color: #F6F6F4">(</span><span style="color: #FFB86C; font-style: italic">el</span><span style="color: #F286C4">:</span><span style="color: #F6F6F4"> </span><span style="color: #97E1F1; font-style: italic">Element</span><span style="color: #F6F6F4">, </span><span style="color: #62E884">onClickOutside</span><span style="color: #F286C4">:</span><span style="color: #F6F6F4"> () </span><span style="color: #F286C4">=&gt;</span><span style="color: #F6F6F4"> </span><span style="color: #97E1F1; font-style: italic">void</span><span style="color: #F6F6F4">) {</span></span>
<span class="line"><span style="color: #F6F6F4">  </span><span style="color: #F286C4">return</span><span style="color: #F6F6F4"> (</span><span style="color: #FFB86C; font-style: italic">e</span><span style="color: #F286C4">:</span><span style="color: #F6F6F4"> </span><span style="color: #97E1F1; font-style: italic">Event</span><span style="color: #F6F6F4">) </span><span style="color: #F286C4">=&gt;</span><span style="color: #F6F6F4"> {</span></span>
<span class="line"><span style="color: #F6F6F4">    </span><span style="color: #F286C4">if</span><span style="color: #F6F6F4"> (el </span><span style="color: #F286C4">&amp;&amp;</span><span style="color: #F6F6F4"> </span><span style="color: #F286C4">!</span><span style="color: #F6F6F4">el.</span><span style="color: #62E884">contains</span><span style="color: #F6F6F4">(e.target </span><span style="color: #F286C4">as</span><span style="color: #F6F6F4"> </span><span style="color: #97E1F1; font-style: italic">HTMLElement</span><span style="color: #F6F6F4">)) {</span></span>
<span class="line"><span style="color: #F6F6F4">      </span><span style="color: #62E884">onClickOutside</span><span style="color: #F6F6F4">()</span></span>
<span class="line"><span style="color: #F6F6F4">    }</span></span>
<span class="line"><span style="color: #F6F6F4">  }</span></span>
<span class="line"><span style="color: #F6F6F4">}</span></span>
<span class="line"><span style="color: #F6F6F4">app.</span><span style="color: #62E884">directive</span><span style="color: #F6F6F4">(</span><span style="color: #DEE492">&#39;</span><span style="color: #E7EE98">click-outside</span><span style="color: #DEE492">&#39;</span><span style="color: #F6F6F4">, {</span></span>
<span class="line"><span style="color: #F6F6F4">  </span><span style="color: #62E884">mounted</span><span style="color: #F6F6F4">(</span><span style="color: #FFB86C; font-style: italic">el</span><span style="color: #F6F6F4">, </span><span style="color: #FFB86C; font-style: italic">binding</span><span style="color: #F6F6F4">) {</span></span>
<span class="line"><span style="color: #F6F6F4">    el.clickOutsideListener </span><span style="color: #F286C4">=</span><span style="color: #F6F6F4"> </span><span style="color: #62E884">listener</span><span style="color: #F6F6F4">(el, binding.value)</span></span>
<span class="line"><span style="color: #F6F6F4">    document.</span><span style="color: #62E884">addEventListener</span><span style="color: #F6F6F4">(binding.arg </span><span style="color: #F286C4">||</span><span style="color: #F6F6F4"> </span><span style="color: #DEE492">&#39;</span><span style="color: #E7EE98">click</span><span style="color: #DEE492">&#39;</span><span style="color: #F6F6F4">, el.clickOutsideListener)</span></span>
<span class="line"><span style="color: #F6F6F4">  },</span></span>
<span class="line"><span style="color: #F6F6F4">  </span><span style="color: #62E884">beforeUnmount</span><span style="color: #F6F6F4">(</span><span style="color: #FFB86C; font-style: italic">el</span><span style="color: #F6F6F4">, </span><span style="color: #FFB86C; font-style: italic">binding</span><span style="color: #F6F6F4">) {</span></span>
<span class="line"><span style="color: #F6F6F4">    document.</span><span style="color: #62E884">removeEventListener</span><span style="color: #F6F6F4">(</span></span>
<span class="line"><span style="color: #F6F6F4">      binding.arg </span><span style="color: #F286C4">||</span><span style="color: #F6F6F4"> </span><span style="color: #DEE492">&#39;</span><span style="color: #E7EE98">click</span><span style="color: #DEE492">&#39;</span><span style="color: #F6F6F4">,</span></span>
<span class="line"><span style="color: #F6F6F4">      el.clickOutsideListener,</span></span>
<span class="line"><span style="color: #F6F6F4">    )</span></span>
<span class="line"><span style="color: #F6F6F4">  },</span></span>
<span class="line"><span style="color: #F6F6F4">})</span></span>
<span class="line"></span></code></pre></div><p>Usage:</p><div><pre class="shiki" style="background-color: #282A36"><code><span class="line"><span style="color: #F6F6F4">&lt;</span><span style="color: #F286C4">div</span><span style="color: #F6F6F4"> </span><span style="color: #62E884; font-style: italic">v-click-outside:mouseup</span><span style="color: #F286C4">=</span><span style="color: #DEE492">&quot;</span><span style="color: #E7EE98">onClickOutside</span><span style="color: #DEE492">&quot;</span><span style="color: #F6F6F4">&gt;&lt;/</span><span style="color: #F286C4">div</span><span style="color: #F6F6F4">&gt;</span></span>
<span class="line"></span></code></pre></div><!--]--><!--]--></article><footer class="h-16"></footer></main></article></div>
<script type="module" src="/vue-cookbook/assets/_default.page.client.ts.b6301580.js"></script><script id="vite-plugin-ssr_pageContext" type="application/json">{"pageContext":{"_pageId":"/src/pages/utilities/02-detect-click-outside","pageProps":"!undefined","urlParsedServer":{"origin":null,"pathnameWithBaseUrl":"/utilities/02-detect-click-outside","hasBaseUrl":false,"search":{},"searchString":null,"hash":"","hashString":null,"isPageContextRequest":false,"pathname":"/utilities/02-detect-click-outside"}}}</script></body>
</html>
